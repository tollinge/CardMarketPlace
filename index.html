<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Produits tri√©s par prix</title>
    <!-- ‚úÖ Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light py-5">

    <div class="container">
        <h1 class="mb-4">üÉè Produits tri√©s par prix</h1>

        <!-- üîç Barre de recherche -->
        <div class="mb-3">
            <input type="text" id="search" class="form-control" placeholder="Rechercher un produit par nom...">
        </div>

        <!-- üîÉ Tri par prix -->
        <div class="mb-3">
            <button id="sort-btn" class="btn btn-outline-primary">
                Trier par prix d√©croissant üîΩ
            </button>
        </div>

        <!-- üßæ Tableau -->
        <table class="table table-striped table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Nom</th>
                    <th>Prix</th>
                </tr>
            </thead>
            <tbody id="product-table">
                {% for p in products %}
                <tr>
                    <td>{{ p.rank }}</td>
                    <td class="product-name">{{ p.name }}</td>
                    <td class="product-price">{{ "%.2f"|format(p.price) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ‚úÖ Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ‚úÖ Script de filtrage et tri -->
    <script>
        const searchInput = document.getElementById('search');
        const sortBtn = document.getElementById('sort-btn');
        const tableBody = document.getElementById('product-table');

        let currentSortDescending = true;

        // Fonction de tri
        function sortTable(descending = true) {
            const rows = Array.from(tableBody.querySelectorAll("tr"));

            rows.sort((a, b) => {
                const priceA = parseFloat(a.querySelector(".product-price").textContent);
                const priceB = parseFloat(b.querySelector(".product-price").textContent);
                return descending ? priceB - priceA : priceA - priceB;
            });

            // R√©injecter les lignes tri√©es
            rows.forEach(row => tableBody.appendChild(row));
        }

        // Fonction de filtre par nom
        function filterTable() {
            const searchTerm = searchInput.value.toLowerCase();
            const rows = tableBody.querySelectorAll("tr");

            rows.forEach(row => {
                const name = row.querySelector(".product-name").textContent.toLowerCase();
                row.style.display = name.includes(searchTerm) ? "" : "none";
            });
        }

        // √âv√©nements
        searchInput.addEventListener("input", filterTable);

        sortBtn.addEventListener("click", () => {
            currentSortDescending = !currentSortDescending;
            sortTable(currentSortDescending);

            // Met √† jour le texte du bouton
            sortBtn.textContent = currentSortDescending
                ? "Trier par prix d√©croissant üîΩ"
                : "Trier par prix croissant üîº";
        });

        // Initialisation
        sortTable(true);
    </script>
</body>
</html>

